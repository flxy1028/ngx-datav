<svg
  [attr.width]="svgWH[0]"
  [attr.height]="svgWH[1]"
  style.transform="transform: scale({{ svgScale[0] }},{{ svgScale[1] }});"
>
  <ng-container *ngFor="let point of points; index as i">
    <rect
      *ngIf="point[2] > 0.6"
      [attr.fill]="_colors[0]"
      [attr.x]="point[0] - halfPointSideLength"
      [attr.y]="point[1] - halfPointSideLength"
      [attr.width]="pointSideLength"
      [attr.height]="pointSideLength"
    >
      <animate
        *ngIf="point[3] > 0.6"
        attributeName="fill"
        attr.values="{{ _colors[0] }};transparent"
        dur="1s"
        [attr.begin]="point[4] * 2"
        repeatCount="indefinite"
      />
    </rect>
  </ng-container>

  <rect
    *ngIf="rects[0]"
    [attr.fill]="_colors[1]"
    [attr.x]="rects[0][0] - pointSideLength"
    [attr.y]="rects[0][1] - pointSideLength"
    [attr.width]="pointSideLength * 2"
    [attr.height]="pointSideLength * 2"
  >
    <animate
      attributeName="width"
      attr.values="0;{{ pointSideLength * 2 }}"
      dur="2s"
      repeatCount="indefinite"
    />
    <animate
      attributeName="height"
      attr.values="0;{{ pointSideLength * 2 }}"
      dur="2s"
      repeatCount="indefinite"
    />
    <animate
      attributeName="x"
      attr.values="{{ rects[0][0] }};{{ rects[0][0] - pointSideLength }}"
      dur="2s"
      repeatCount="indefinite"
    />
    <animate
      attributeName="y"
      attr.values="{{ rects[0][1] }};{{ rects[0][1] - pointSideLength }}"
      dur="2s"
      repeatCount="indefinite"
    />
  </rect>

  <rect
    *ngIf="rects[1]"
    [attr.fill]="_colors[1]"
    [attr.x]="rects[1][0] - 40"
    [attr.y]="rects[1][1] - pointSideLength"
    width="40"
    [attr.height]="pointSideLength * 2"
  >
    <animate
      attributeName="width"
      values="0;40;0"
      dur="2s"
      repeatCount="indefinite"
    />
    <animate
      attributeName="x"
      attr.values="{{ rects[1][0] }};{{ rects[1][0] - 40 }};{{ rects[1][0] }}"
      dur="2s"
      repeatCount="indefinite"
    />
  </rect>
</svg>
